{"version":3,"file":"index-Hcdoouu2.js","sources":["../../src/views/print2/index.vue"],"sourcesContent":["<!--\n * @Author: wufengliang 44823912@qq.com\n * @Date: 2025-06-23 16:29:26\n * @LastEditTime: 2025-06-30 15:47:28\n * @Description: \n-->\n<template>\n    <div class=\"p-2 box-border h-full overflow-hidden flex\">\n        <div class=\"overflow-y-auto w-[50%] flex-shrink-0\">\n            <a-form>\n                <a-form-item label=\"打印区域宽度\">\n                    <a-input-number v-model:value=\"printOptions.width\" />\n                </a-form-item>\n                <a-form-item label=\"打印区域高度\">\n                    <a-input-number v-model:value=\"printOptions.height\" />\n                </a-form-item>\n                <a-form-item label=\"打印方向\">\n                    <a-select v-model:value=\"printOptions.orient\">\n                        <a-select-option :value=\"1\">纵向（portrait）</a-select-option>\n                        <a-select-option :value=\"0\">横向（landscape）</a-select-option>\n                    </a-select>\n                </a-form-item>\n                <a-card v-for=\"(item, index) in list\" class=\"mb-2\" :key=\"index\"\n                    :title=\"`${item.textType === 'qrcode' ? '二维码' : `内容项${index + 1}`}`\">\n                    <a-form-item label=\"内容\">\n                        <a-input v-model:value=\"item.title\" />\n                    </a-form-item>\n                    <a-form-item label=\"宽度\">\n                        <a-input-number v-model:value=\"item.width\" />\n                    </a-form-item>\n                    <a-form-item label=\"高度\">\n                        <a-input-number v-model:value=\"item.height\" />\n                    </a-form-item>\n                    <a-form-item label=\"距离左上Y距离\">\n                        <a-input-number v-model:value=\"item.top\" />\n                    </a-form-item>\n                    <a-form-item label=\"距离左上X距离\">\n                        <a-input-number v-model:value=\"item.left\" />\n                    </a-form-item>\n                    <a-form-item label=\"行高\">\n                        <a-input-number v-model:value=\"item.lineHeight\" />\n                    </a-form-item>\n                    <a-form-item label=\"字体大小\">\n                        <a-input-number v-model:value=\"item.fontSize\" />\n                    </a-form-item>\n                    <a-form-item label=\"缩放大小\">\n                        <a-input-number v-model:value=\"item.scale\" />\n                    </a-form-item>\n                    <a-form-item label=\"字体格式\">\n                        <a-select v-model:value=\"item.fontFamily\" class='w-full'>\n                            <a-select-option value=\"Noto Sans SC\">思源黑体</a-select-option>\n                            <a-select-option value=\"alibaba\">阿里巴巴普惠体</a-select-option>\n                        </a-select>\n                    </a-form-item>\n                    <a-form-item label=\"对齐格式\">\n                        <a-select v-model:value=\"item.textAlign\">\n                            <a-select-option value=\"left\">左对齐</a-select-option>\n                            <a-select-option value=\"center\">居中</a-select-option>\n                            <a-select-option value=\"right\">右对齐</a-select-option>\n                        </a-select>\n                    </a-form-item>\n                    <a-form-item label=\"字体粗细\">\n                        <a-select v-model:value=\"item.fontWeight\">\n                            <a-select-option value=\"bold\">加粗</a-select-option>\n                            <a-select-option value=\"\">普通</a-select-option>\n                        </a-select>\n                    </a-form-item>\n                </a-card>\n            </a-form>\n        </div>\n        <div class=\"w-[50%] box-border p-2 flex-shrink-0\">\n            <div>\n                <a-button type=\"primary\" class=\"mx-2\" @click=\"printData('web')\">WEB打印</a-button>\n                <a-button type=\"primary\" class=\"mx-2\" @click=\"printData('static')\">静默打印</a-button>\n                <a-button type=\"primary\" class=\"mx-2\" @click=\"printData('single')\">打印单条数据</a-button>\n                <a-button type=\"primary\" class=\"mx-2\" @click=\"printData('many')\">批量打印</a-button>\n            </div>\n\n            <div style=\"height:450px;overflow-y: auto;background: #000;color:#fff;margin:40px auto\">{{ str }}</div>\n\n            <div id=\"design\"></div>\n        </div>\n    </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { reactive, ref, onMounted, watch } from 'vue';\nimport { hiprint } from 'vue-plugin-hiprint';\nimport type { IPrintItemOptions } from './type';\n\nconst panel = ref<Record<string, any>>()\nconst hiprintTemplate = ref<Record<string, any>>();\n\nconst printOptions = reactive({\n    width: 70,\n    height: 20,\n    orient: 1,\n})\n\nconst str = ref('');\n\nconst testValue = {\n    qrcode: \"test\",\n    title: \"这是name\",\n    subTitle: \"这是subTitle\",\n    type: \"这是type\",\n    subType: \"这是subType\",\n    test: \"test\",\n    testValue: \"testValue\",\n    test2: \"test2\",\n    test2Value: \"test2Value\",\n    test3: \"test3\",\n    test3Value: \"test3Value\",\n    test4: \"test4\",\n    test4Value: \"test4Value\",\n    test5: \"test5\",\n    test5Value: \"test5Value\"\n}\n\nconst list = ref([\n    {\n        textType: 'qrcode',\n        width: 35,\n        height: 35,\n        top: 10,\n        left: 2,\n        title: '123456',\n        fontFamily: 'Noto Sans SC',\n        fontSize: 9,\n        lineHeight: 9.75,\n        scale: 1,\n        hideTitle: true\n    },\n    {\n        width: 75,\n        height: 7,\n        top: 46,\n        left: -17,\n        title: 'KCY1234567980',\n        fontFamily: 'Noto Sans SC',\n        fontSize: 9,\n        textAlign: 'left',\n        fontWeight: 'bold',\n        lineHeight: 19.5,\n        scale: 0.5,\n        field: \"title\"\n    },\n    {\n        width: 110,\n        height: 15,\n        top: 5,\n        left: 40,\n        title: '五虎上将·关羽',\n        fontFamily: 'Noto Sans SC',\n        textAlign: 'center',\n        fontSize: 14,\n        lineHeight: 1,\n        fontWeight: 'bold',\n        scale: 0.5,\n        field: 'subTitle'\n    },\n    {\n        width: 200,\n        height: 15,\n        top: 15,\n        left: -10,\n        title: '华立科技 •《三国幻战》•中国简中',\n        fontFamily: 'Noto Sans SC',\n        fontSize: 12,\n        lineHeight: 1,\n        textAlign: 'center',\n        fontWeight: 'bold',\n        scale: 0.5,\n        field: \"type\"\n    },\n    {\n        width: 110,\n        height: 15,\n        top: 22,\n        left: 40,\n        title: '2025年 五虎上将系列',\n        fontFamily: 'Noto Sans SC',\n        fontSize: 10,\n        lineHeight: 1,\n        textAlign: 'center',\n        fontWeight: 'bold',\n        scale: 0.5,\n        field: \"subType\",\n    },\n    {\n        width: 55,\n        height: 15,\n        top: 33,\n        left: 45,\n        title: 'CENTERING',\n        fontFamily: 'Noto Sans SC',\n        textAlign: 'left',\n        lineHeight: 1,\n        fontWeight: 'bold',\n        scale: 0.5,\n        field: \"test\"\n    },\n    {\n        width: 15,\n        height: 15,\n        top: 33,\n        left: 85,\n        title: '10',\n        fontFamily: 'Noto Sans SC',\n        lineHeight: 1,\n        textAlign: 'left',\n        fontWeight: 'bold',\n        scale: 0.5,\n        field: \"testValue\"\n    },\n    {\n        width: 50,\n        height: 15,\n        top: 33,\n        left: 90,\n        title: 'CORNERS',\n        fontFamily: 'Noto Sans SC',\n        textAlign: 'left',\n        lineHeight: 1,\n        fontWeight: 'bold',\n        scale: 0.5,\n        field: \"test2\",\n    },\n    {\n        width: 15,\n        height: 15,\n        top: 33,\n        left: 122,\n        title: '10',\n        fontFamily: 'Noto Sans SC',\n        textAlign: 'left',\n        lineHeight: 1,\n        fontWeight: 'bold',\n        fontSize: 10,\n        scale: 0.5,\n        field: \"test2Value\"\n    },\n    {\n        width: 55,\n        height: 15,\n        top: 40,\n        left: 45,\n        title: 'EDEGS',\n        fontFamily: 'Noto Sans SC',\n        lineHeight: 1,\n        textAlign: 'left',\n        fontWeight: 'bold',\n        scale: 0.5,\n        field: \"test3\"\n    },\n    {\n        width: 15,\n        height: 15,\n        top: 40,\n        left: 85,\n        title: '10',\n        fontFamily: 'Noto Sans SC',\n        lineHeight: 1,\n        textAlign: 'left',\n        fontWeight: 'bold',\n        scale: 0.5,\n        field: \"test3Value\"\n    },\n    {\n        width: 50,\n        height: 15,\n        top: 40,\n        left: 90,\n        title: 'SURFACE',\n        fontFamily: 'Noto Sans SC',\n        lineHeight: 1,\n        textAlign: 'left',\n        fontWeight: 'bold',\n        scale: 0.5,\n        field: \"test4\"\n    },\n    {\n        width: 15,\n        height: 15,\n        top: 40,\n        left: 122,\n        title: \"10\",\n        fontFamily: 'Noto Sans SC',\n        textAlign: 'left',\n        lineHeight: 1,\n        fontWeight: 'bold',\n        scale: 0.5,\n        field: \"test4Value\"\n    },\n    {\n        width: 130,\n        height: 15,\n        top: 9,\n        left: 104,\n        title: 'GEM MINT',\n        fontFamily: \"Noto Sans SC\",\n        textAlign: 'center',\n        fontSize: 16,\n        fontWeight: \"bold\",\n        lineHeight: 1,\n        scale: 0.5,\n        field: \"test5\",\n    },\n    {\n        width: 55,\n        height: 15,\n        top: 29,\n        left: 142,\n        title: '9.5',\n        fontFamily: \"Noto Sans SC\",\n        textAlign: 'center',\n        fontSize: 28,\n        fontWeight: \"bold\",\n        lineHeight: 1,\n        scale: 1,\n        field: \"test5Value\"\n    }\n])\n\n/**\n * 绘制\n */\nconst drawPrint = () => {\n    panel.value?.clear();\n    hiprintTemplate.value?.clear();\n    document.getElementById('design').innerHTML = '';\n    let _str = '';\n\n    hiprintTemplate.value = new hiprint.PrintTemplate();\n    panel.value = hiprintTemplate.value.addPrintPanel({ width: printOptions.width, height: printOptions.height, paperFooter: 0, paperHeader: 0, paperNumberDisabled: true, orient: printOptions.orient });\n\n    panel.value.addPrintText({ options: { width: printOptions.width, height: printOptions.height, top: 0, left: 0, src: \"https://search-operate.cdn.bcebos.com/c63f5b937296e91b1a9a79a63328b2a6.gif\" }, printElementType: { type: 'image' } })\n\n    list.value.forEach((i, index) => {\n        const { textType = 'text', width, height, left, top, title, scale = 1, fontSize = 9, fontFamily = 'Noto Sans SC', lineHeight = 9.75, hideTitle = false } = i as IPrintItemOptions;\n        const options: Record<string, any> = { width, height, left, top, title, fontSize, fontFamily, lineHeight, hideTitle };\n        if (textType === 'qrcode') {\n            Object.assign(options, { textType: 'qrcode' })\n        }\n        if (!!i.textAlign) {\n            Object.assign(options, { textAlign: i.textAlign })\n        }\n        if (i.fontWeight === 'bold') {\n            Object.assign(options, { fontWeight: 'bold' })\n        }\n\n        const fn = new Function(`return { transform:\"scale(${scale || 1})\" }`)\n        const tempOptions = { ...options };\n\n        Object.assign(options, {\n            styler: fn\n        })\n\n        Object.assign(tempOptions, {\n            styler: `function(){return {transform:'scale(${scale || 1})'}}`\n        })\n\n        panel.value.addPrintText({ options });\n        _str += JSON.stringify(tempOptions) + (index === list.value.length - 1 ? \"\" : \",\");\n    })\n\n    hiprintTemplate.value.design('#design');\n    str.value = \"[\" + _str + \"]\"\n}\n\n/**\n * 打印数据\n */\nconst printData = (type: 'static' | 'web' | 'single' | 'many') => {\n    if (type === 'web') {\n        console.log(hiprintTemplate.value);\n        return hiprintTemplate.value.print({});\n    }\n\n    if (type === 'static') {\n        console.log('static')\n        return hiprintTemplate.value.print2({});\n    }\n\n    if (type === 'single') {\n        console.log(hiprintTemplate.value.getPrinterList());\n        return hiprintTemplate.value.print([testValue]);\n    }\n}\n\nonMounted(() => {\n    hiprint.init();\n    hiprint?.hiwebSocket?.stop();\n    drawPrint();\n})\n\nwatch([printOptions, list], () => {\n    drawPrint();\n}, { deep: true });\n\n</script>\n\n<style lang=\"scss\" scoped>\n.json-box {\n    height: 350px;\n    background-color: #f00;\n}\n</style>"],"names":["panel","ref","hiprintTemplate","printOptions","reactive","width","height","orient","str","testValue","qrcode","title","subTitle","type","subType","test","test2","test2Value","test3","test3Value","test4","test4Value","test5","test5Value","list","textType","top","left","fontFamily","fontSize","lineHeight","scale","hideTitle","textAlign","fontWeight","field","drawPrint","_a","value","clear","_b","document","getElementById","innerHTML","_str","hiprint","PrintTemplate","addPrintPanel","paperFooter","paperHeader","paperNumberDisabled","addPrintText","options","src","printElementType","forEach","i","index","Object","assign","fn","Function","tempOptions","styler","JSON","stringify","length","design","printData","console","log","print","print2","getPrinterList","onMounted","init","hiwebSocket","stop","watch","deep"],"mappings":"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"}