{"version":3,"file":"index-Cplcra3z.js","sources":["../../src/views/print3/width.vue","../../src/views/print3/json.vue","../../src/views/print3/index.vue"],"sourcesContent":["<!--\n * @Author: wufengliang 44823912@qq.com\n * @Date: 2025-07-01 16:44:48\n * @LastEditTime: 2025-07-01 16:47:08\n * @Description: \n-->\n<template>\n    <a-form>\n        <a-form-item label=\"宽度\">\n            <a-input-number v-model:value=\"options.width\" />\n        </a-form-item>\n        <a-form-item label=\"高度\">\n            <a-input-number v-model:value=\"options.height\" />\n        </a-form-item>\n    </a-form>\n</template>\n\n<script lang=\"ts\" setup>\nimport { reactive } from 'vue';\n\nconst options = reactive({ width: 70, height: 40 });\n\ndefineExpose({\n    options\n})\n</script>","<!--\n * @Author: wufengliang 44823912@qq.com\n * @Date: 2025-07-01 17:35:48\n * @LastEditTime: 2025-07-06 12:27:22\n * @Description: \n-->\n<template>\n    <a-textarea v-model:value=\"value\" :rows=\"14\"></a-textarea>\n</template>\n\n<script lang=\"ts\" setup>\nimport { ref } from 'vue';\n\nconst props = defineProps({\n    value: {\n        type: Object,\n        default: () => ({})\n    }\n})\n\nconst value = ref(JSON.stringify(props.value, null, 4))\n\ndefineExpose({\n    value: () => value.value\n})\n</script>","<!--\n * @Author: wufengliang 44823912@qq.com\n * @Date: 2025-06-30 21:16:10\n * @LastEditTime: 2025-07-07 17:47:22\n * @Description: 自定义打印\n-->\n<template>\n    <div>\n        <div class=\"mb-[20px]\">\n            <a-button type=\"primary\" @click=\"lookJson\">查看JSON数据</a-button>\n            <a-button class=\"ml-[10px]\" type=\"primary\" @click=\"setConfig\">设置大小</a-button>\n            <a-button class=\"ml-[10px]\" type=\"primary\" @click=\"print('web')\">web打印</a-button>\n            <a-button class=\"ml-[10px]\" type=\"primary\" @click=\"print('client')\">打印机打印</a-button>\n        </div>\n        <a-row :gutter=\"[8, 0]\">\n            <a-col :span=\"4\">\n                <a-card style=\"height: 100vh\">\n                    <a-row>\n                        <a-col :span=\"24\" class=\"rect-printElement-types hiprintEpContainer\">\n                            <a-row class=\"drag_item_title\">拖拽组件列表</a-row>\n                            <a-row style=\"height: 100px;\">\n                                <a-col :span=\"12\" class=\"drag_item_box\">\n                                    <div>\n                                        <a class=\"ep-draggable-item\" tid=\"defaultModule.text\">\n                                            <span class=\"glyphicon glyphicon-text-width\" aria-hidden=\"true\"></span>\n                                            <p class=\"glyphicon-class\">文本</p>\n                                        </a>\n                                    </div>\n                                </a-col>\n                                <!-- <a-col :span=\"12\" class=\"drag_item_box\">\n                                    <div>\n                                        <a class=\"ep-draggable-item\" tid=\"defaultModule.image\">\n                                            <span class=\"glyphicon glyphicon-picture\" aria-hidden=\"true\"></span>\n                                            <p class=\"glyphicon-class\">图片</p>\n                                        </a>\n                                    </div>\n                                </a-col> -->\n                            </a-row>\n                            <a-row style=\"height: 100px;\">\n                                <a-col :span=\"12\" class=\"drag_item_box\">\n                                    <div>\n                                        <a class=\"ep-draggable-item\" tid=\"defaultModule.longText\">\n                                            <span class=\"glyphicon glyphicon-subscript\" aria-hidden=\"true\"></span>\n                                            <p class=\"glyphicon-class\">长文</p>\n                                        </a>\n                                    </div>\n                                </a-col>\n                                <a-col :span=\"12\" class=\"drag_item_box\">\n                                    <div>\n                                        <a class=\"ep-draggable-item\" tid=\"defaultModule.table\">\n                                            <span class=\"glyphicon glyphicon-th\" aria-hidden=\"true\"></span>\n                                            <p class=\"glyphicon-class\">表格</p>\n                                        </a>\n                                    </div>\n                                </a-col>\n                            </a-row>\n                            <a-row style=\"height: 100px;\">\n                                <a-col :span=\"12\" class=\"drag_item_box\">\n                                    <div>\n                                        <a class=\"ep-draggable-item\" tid=\"defaultModule.emptyTable\">\n                                            <span class=\"glyphicon glyphicon-th\" aria-hidden=\"true\"></span>\n                                            <p class=\"glyphicon-class\">空白表格</p>\n                                        </a>\n                                    </div>\n                                </a-col>\n                            </a-row>\n                            <a-row style=\"height: 100px;\">\n                                <a-col :span=\"12\" class=\"drag_item_box\">\n                                    <div>\n                                        <a class=\"ep-draggable-item\" tid=\"defaultModule.html\" style=\"\">\n                                            <span class=\"glyphicon glyphicon-header\" aria-hidden=\"true\"></span>\n                                            <p class=\"glyphicon-class\">html</p>\n                                        </a>\n                                    </div>\n                                </a-col>\n                                <a-col :span=\"12\" class=\"drag_item_box\">\n                                    <div>\n                                        <a class=\"ep-draggable-item\" tid=\"defaultModule.customText\">\n                                            <span class=\"glyphicon glyphicon-text-width\" aria-hidden=\"true\"></span>\n                                            <p class=\"glyphicon-class\">自定义</p>\n                                        </a>\n                                    </div>\n                                </a-col>\n                            </a-row>\n                            <a-row class=\"drag_item_title\">辅助</a-row>\n                            <!-- <a-row style=\"height: 100px;\">\n                                <a-col :span=\"12\" class=\"drag_item_box\">\n                                    <div>\n                                        <a class=\"ep-draggable-item\" tid=\"defaultModule.hline\">\n                                            <span class=\"glyphicon glyphicon-resize-horizontal\"\n                                                aria-hidden=\"true\"></span>\n                                            <p class=\"glyphicon-class\">横线</p>\n                                        </a>\n                                    </div>\n                                </a-col>\n                                <a-col :span=\"12\" class=\"drag_item_box\">\n                                    <div>\n                                        <a class=\"ep-draggable-item\" tid=\"defaultModule.vline\">\n                                            <span class=\"glyphicon glyphicon-resize-vertical\" aria-hidden=\"true\"></span>\n                                            <p class=\"glyphicon-class\">竖线</p>\n                                        </a>\n                                    </div>\n                                </a-col>\n                            </a-row> -->\n                            <!-- <a-row style=\"height: 100px;\">\n                                <a-col :span=\"12\" class=\"drag_item_box\">\n                                    <div>\n                                        <a class=\"ep-draggable-item\" tid=\"defaultModule.rect\">\n                                            <span class=\"glyphicon glyphicon-unchecked\" aria-hidden=\"true\"></span>\n                                            <p class=\"glyphicon-class\">矩形</p>\n                                        </a>\n                                    </div>\n                                </a-col>\n                                <a-col :span=\"12\" class=\"drag_item_box\">\n                                    <div>\n                                        <a class=\"ep-draggable-item\" tid=\"defaultModule.oval\">\n                                            <span class=\"glyphicon glyphicon-record\" aria-hidden=\"true\"></span>\n                                            <p class=\"glyphicon-class\">椭圆</p>\n                                        </a>\n                                    </div>\n                                </a-col>\n                            </a-row> -->\n                            <a-row style=\"height: 100px;\">\n                                <a-col :span=\"12\" class=\"drag_item_box\">\n                                    <div>\n                                        <a class=\"ep-draggable-item\" tid=\"defaultModule.barcode\">\n                                            <span class=\"glyphicon glyphicon-barcode\" aria-hidden=\"true\"></span>\n                                            <p class=\"glyphicon-class\">条形码</p>\n                                        </a>\n                                    </div>\n                                </a-col>\n                                <a-col :span=\"12\" class=\"drag_item_box\">\n                                    <div>\n                                        <a class=\"ep-draggable-item\" tid=\"defaultModule.qrcode\">\n                                            <span class=\"glyphicon glyphicon-qrcode\" aria-hidden=\"true\"></span>\n                                            <p class=\"glyphicon-class\">二维码</p>\n                                        </a>\n                                    </div>\n                                </a-col>\n                            </a-row>\n                        </a-col>\n                    </a-row>\n                </a-card>\n            </a-col>\n            <a-col :span=\"15\">\n                <a-card class=\"card-design\">\n                    <div id=\"hiprint-printTemplate\" class=\"hiprint-printTemplate\"></div>\n                </a-card>\n            </a-col>\n            <a-col :span=\"5\" class=\"params_setting_container\">\n                <a-card>\n                    <a-row class=\"hinnn-layout-sider\">\n                        <div id=\"PrintElementOptionSetting\"></div>\n                    </a-row>\n                </a-card>\n            </a-col>\n        </a-row>\n    </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { onMounted, ref, toRaw, computed } from 'vue';\nimport { hiprint, defaultElementTypeProvider } from \"vue-plugin-hiprint\";\nimport $ from 'jquery';\nimport { createModal } from '@/global/create-modal';\nimport WidthTemplate from './width.vue';\nimport JsonTemplate from './json.vue';\nimport { webPrint, clientPrint } from './params';\n\nconst hiprintTemplate = ref();\nconst panel = ref();\nconst printData = ref({\n    qrcode: 'KCY1234567980',\n    qrValue: 'KCY1234567980',\n    title: '五虎上将·关羽',\n    type: '华立科技 •《三国幻战》•中国简中',\n    subType: '2025年 五虎上将系列',\n    centTitle: 'CENTERING',\n    centValue: '10',\n    corTitle: 'CORNERS',\n    corValue: '10',\n    edeTitle: 'EDEGS',\n    edeValue: '10',\n    surfaceTitle: 'SURFACE',\n    surfaceValue: '10',\n    genTitle: 'GEM MINT',\n    genValue: '9.5'\n});\n\nconst init = (template: Record<string, any> = {}) => {\n    hiprintTemplate.value?.clear()\n    hiprint.init({\n        providers: [new defaultElementTypeProvider()],\n    });\n    // 还原配置\n    hiprint.setConfig()\n    // eslint-disable-next-line no-undef\n    hiprint.PrintElementTypeManager.buildByHtml($('.ep-draggable-item'));\n    $('#hiprint-printTemplate').empty()\n    if (template.panels && template?.panels?.[0]) {\n        template.panels[0].paperNumberDisabled = true;\n    }\n    hiprintTemplate.value = new hiprint.PrintTemplate({\n        template,\n        // 图片选择功能\n        onImageChooseClick: (target) => {\n            // 测试 3秒后修改图片地址值\n            setTimeout(() => {\n                target.refresh(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtAAAAIIAQMAAAB99EudAAAABlBMVEUmf8vG2O41LStnAAABD0lEQVR42u3XQQqCQBSAYcWFS4/QUTpaHa2jdISWLUJjjMpclJoPGvq+1WsYfiJCZ4oCAAAAAAAAAAAAAAAAAHin6pL9c6H/fOzHbRrP0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0u/SY9LS0tLS0tLS0tLS0n+edm+UlpaWlpaWlpaWlpaW/tl0Ndyzbno7/+tPTJdd1wal69dNa6abx+Lq6TSeYtK7BX/Diek0XULSZZrakPRtV0i6Hu/KIt30q4fM0pvBqvR9mvsQkZaW9gyJT+f5lsnzjR54xAk8mAUeJyMPwYFH98ALx5Jr0kRLLndT7b64UX9QR/0eAAAAAAAAAAAAAAAAAAD/4gpryzr/bja4QgAAAABJRU5ErkJggg==\", {\n                    // auto: true, // 根据图片宽高自动等比(宽>高?width:height)\n                    // width: true, // 按宽调整高\n                    // height: true, // 按高调整宽\n                    real: true // 根据图片实际尺寸调整(转pt)\n                })\n            }, 3000)\n            // target.getValue()\n            // target.refresh(url)\n        },\n        // 自定义可选字体\n        // 或者使用 hiprintTemplate.setFontList([])\n        // 或元素中 options.fontList: []\n        fontList: [\n            { title: '思源黑体', value: 'Noto Sans SC' },\n            { title: '阿里巴巴普惠体', value: 'alibaba' },\n        ],\n        dataMode: 1, // 1:getJson 其他：getJsonTid 默认1\n        history: true, // 是否需要 撤销重做功能\n        willOutOfBounds: true, // 是否允许组件内的控件超出范围\n        qtDesigner: true, // 是否开启类似QT Designer的唯一field生成模式\n        onDataChanged: (type, json) => {\n            console.log(type); // 新增、移动、删除、修改(参数调整)、大小、旋转\n            console.log(json); // 返回 template\n        },\n        onUpdateError: (e) => {\n            console.log(e);\n        },\n        settingContainer: '#PrintElementOptionSetting',\n        paginationContainer: '.hiprint-printPagination'\n    });\n    hiprintTemplate.value.design('#hiprint-printTemplate', { grid: true });\n    console.log(hiprintTemplate);\n    // 获取当前放大比例, 当zoom时传true 才会有\n    // this.scaleValue = hiprintTemplate.value.editingPanel.scale || 1;\n}\n\n/**\n * 查看json\n */\nconst lookJson = () => {\n    const json = hiprintTemplate.value?.getJson();\n    let str\n    try {\n        str = JSON.parse(localStorage.getItem('hiprintTemplate'));\n    } catch (e) {\n        str = {};\n    }\n    createModal({\n        title: '查看json数据',\n        component: JsonTemplate,\n        componentOptions: {\n            value: json || str\n        },\n        beforeClose: async (v) => {\n            let val;\n            try {\n                val = JSON.parse(v.value());\n            } finally {\n                if (val) {\n                    localStorage.setItem('hiprintTemplate', JSON.stringify(val));\n                    init(val);\n                }\n            }\n        }\n    })\n}\n\n/**\n * 设置大小\n */\nconst setConfig = () => {\n    createModal({\n        title: '设置大小',\n        component: WidthTemplate,\n        beforeClose: v => {\n            const { width, height } = toRaw(v.options);\n            if (width && height) {\n                hiprintTemplate.value?.setPaper(width, height)\n            }\n        }\n    })\n}\n\n/**\n * 打印\n */\nconst print = (type: 'client' | 'web') => {\n    if (!panel.value) {\n        console.log(hiprintTemplate.value);\n\n        console.log(hiprintTemplate.value?.getJson());\n        panel.value = hiprintTemplate.value?.getJson();\n    }\n    console.log(panel.value);\n    if (type === 'web') {\n        return hiprintTemplate.value?.print(printData.value);\n    }\n\n    if (type === 'client') {\n        return hiprintTemplate.value?.print2();\n    }\n}\n\nonMounted(() => {\n    let str;\n    try {\n        str = JSON.parse(localStorage.getItem('hiprintTemplate'));\n    } catch (error) {\n        str = {};\n    }\n    init(str);\n})\n\n</script>\n\n<style lang=\"scss\" scoped>\n.btn-text-desc {\n    width: 12vw;\n    text-align: right;\n    white-space: nowrap;\n}\n\n// 拖拽\n.drag_item_box {\n    height: 100%;\n    padding: 6px;\n}\n\n.drag_item_box>div {\n    height: 100%;\n    width: 100%;\n    background-color: #fff;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.drag_item_box>div>a {\n    text-align: center;\n    text-decoration-line: none;\n}\n\n.drag_item_box>div>a>span {\n    font-size: 28px;\n}\n\n.drag_item_box>div>a>p {\n    margin: 0;\n}\n\n.drag_item_title {\n    font-size: 16px;\n    padding: 12px 6px 0 6px;\n    font-weight: bold;\n}\n\n:deep(.hiprint-printElement-image-content) {\n    img {\n        content: url(\"~@/assets/logo.png\");\n    }\n}\n\n:deep(.toplineOfPosition) {\n    border: 0;\n    border-top: 1px dashed purple;\n}\n\n:deep(.bottomlineOfPosition) {\n    border: 0;\n    border-top: 1px dashed purple;\n}\n\n:deep(.leftlineOfPosition) {\n    border: 0;\n    border-left: 1px dashed purple;\n}\n\n:deep(.rightlineOfPosition) {\n    border: 0;\n    border-left: 1px dashed purple;\n}\n\n.card-design {\n    overflow: hidden;\n    overflow-x: auto;\n    overflow-y: auto;\n}\n</style>"],"names":["options","reactive","width","height","__expose","props","__props","value","ref","JSON","stringify","hiprintTemplate","panel","printData","qrcode","qrValue","title","type","subType","centTitle","centValue","corTitle","corValue","edeTitle","edeValue","surfaceTitle","surfaceValue","genTitle","genValue","init","template","_a","clear","hiprint","providers","defaultElementTypeProvider","setConfig","PrintElementTypeManager","buildByHtml","$","empty","panels","_b","paperNumberDisabled","PrintTemplate","onImageChooseClick","target","setTimeout","refresh","real","fontList","dataMode","history","willOutOfBounds","qtDesigner","onDataChanged","json","console","log","onUpdateError","e","settingContainer","paginationContainer","design","grid","lookJson","getJson","str","parse","localStorage","getItem","createModal","component","JsonTemplate","componentOptions","beforeClose","async","v","val","setItem","WidthTemplate","toRaw","setPaper","print","_c","_d","print2","onMounted","error"],"mappings":"qdAoBA,MAAMA,EAAUC,EAAS,CAAEC,MAAO,GAAIC,OAAQ,YAEjCC,EAAA,CACTJ,gaCVJ,MAAMK,EAAQC,EAORC,EAAQC,EAAIC,KAAKC,UAAUL,EAAME,MAAO,KAAM,WAEvCH,EAAA,CACTG,MAAO,IAAMA,EAAMA,uLCkJvB,MAAMI,EAAkBH,IAClBI,EAAQJ,IACRK,EAAYL,EAAI,CAClBM,OAAQ,gBACRC,QAAS,gBACTC,MAAO,UACPC,KAAM,oBACNC,QAAS,eACTC,UAAW,YACXC,UAAW,KACXC,SAAU,UACVC,SAAU,KACVC,SAAU,QACVC,SAAU,KACVC,aAAc,UACdC,aAAc,KACdC,SAAU,WACVC,SAAU,QAGRC,EAAO,CAACC,EAAgC,cAC1C,OAAAC,EAAApB,EAAgBJ,QAAOwB,EAAAC,QACvBC,EAAAA,QAAQJ,KAAK,CACTK,UAAW,CAAC,IAAIC,EAAAA,8BAGpBF,EAAAA,QAAQG,YAERH,EAAAA,QAAQI,wBAAwBC,YAAYC,EAAE,uBAC5CA,EAAA,0BAA0BC,QACxBV,EAASW,SAAU,OAAAC,EAAU,MAAAZ,OAAA,EAAAA,EAAAW,iBAAS,MAC7BX,EAAAW,OAAO,GAAGE,qBAAsB,GAE7BhC,EAAAJ,MAAQ,IAAI0B,EAAAA,QAAQW,cAAc,CAC9Cd,WAEAe,mBAAqBC,IAEjBC,WAAW,KACPD,EAAOE,QAAQ,yeAA0e,CAIrfC,MAAM,KAEX,MAOPC,SAAU,CACN,CAAElC,MAAO,OAAQT,MAAO,gBACxB,CAAES,MAAO,UAAWT,MAAO,YAE/B4C,SAAU,EACVC,SAAS,EACTC,iBAAiB,EACjBC,YAAY,EACZC,cAAe,CAACtC,EAAMuC,KAClBC,QAAQC,IAAIzC,GACZwC,QAAQC,IAAIF,IAEhBG,cAAgBC,IACZH,QAAQC,IAAIE,IAEhBC,iBAAkB,6BAClBC,oBAAqB,6BAEzBnD,EAAgBJ,MAAMwD,OAAO,yBAA0B,CAAEC,MAAM,IAC/DP,QAAQC,IAAI/C,IAQVsD,EAAW,WACP,MAAAT,EAAO,OAAAzB,EAAgBpB,EAAAJ,YAAO,EAAAwB,EAAAmC,UAChC,IAAAC,EACA,IACAA,EAAM1D,KAAK2D,MAAMC,aAAaC,QAAQ,0BACjCV,GACLO,EAAM,CAAA,CACV,CACYI,EAAA,CACRvD,MAAO,WACPwD,UAAWC,EACXC,iBAAkB,CACdnE,MAAOiD,GAAQW,GAEnBQ,YAAaC,MAAOC,IACZ,IAAAC,EACA,IACAA,EAAMrE,KAAK2D,MAAMS,EAAEtE,QAAO,CAC5B,QACMuE,IACAT,aAAaU,QAAQ,kBAAmBtE,KAAKC,UAAUoE,IACvDjD,EAAKiD,GAEb,MAQN1C,EAAY,KACFmC,EAAA,CACRvD,MAAO,OACPwD,UAAWQ,EACXL,YAAkBE,UACd,MAAM3E,MAAEA,EAAOC,OAAAA,GAAW8E,EAAMJ,EAAE7E,SAC9BE,GAASC,IACO,OAAA4B,EAAApB,EAAAJ,QAAOwB,EAAAmD,SAAShF,EAAOC,QASjDgF,EAASlE,gBAQX,OAPKL,EAAML,QACCkD,QAAAC,IAAI/C,EAAgBJ,OAE5BkD,QAAQC,IAAI,OAAA3B,EAAApB,EAAgBJ,YAAhB,EAAAwB,EAAuBmC,WAC7BtD,EAAAL,MAAQ,OAAAmC,EAAgB/B,EAAAJ,YAAO,EAAAmC,EAAAwB,WAEjCT,QAAAC,IAAI9C,EAAML,OACL,QAATU,EACO,OAAAmE,EAAgBzE,EAAAJ,YAAO,EAAA6E,EAAAD,MAAMtE,EAAUN,OAGrC,WAATU,EACO,OAAAoE,EAAA1E,EAAgBJ,YAAO,EAAA8E,EAAAC,cADlC,UAKJC,EAAU,KACF,IAAApB,EACA,IACAA,EAAM1D,KAAK2D,MAAMC,aAAaC,QAAQ,0BACjCkB,GACLrB,EAAM,CAAA,CACV,CACAtC,EAAKsC"}