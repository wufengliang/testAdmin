{"version":3,"file":"index-qndvnqrZ.js","sources":["../../src/views/print/index.vue"],"sourcesContent":["<!--\n * @Author: wufengliang 44823912@qq.com\n * @Date: 2025-06-23 16:29:26\n * @LastEditTime: 2025-06-27 14:02:29\n * @Description: \n-->\n<template>\n\n    <div class=\"p-2 box-border h-full overflow-hidden flex\">\n        <div class=\"overflow-y-auto w-[50%] flex-shrink-0\">\n            <a-form>\n                <a-form-item label=\"打印区域宽度\">\n                    <a-input-number v-model:value=\"printOptions.width\" />\n                </a-form-item>\n                <a-form-item label=\"打印区域高度\">\n                    <a-input-number v-model:value=\"printOptions.height\" />\n                </a-form-item>\n                <a-card v-for=\"(item, index) in list\" class=\"mb-2\" :key=\"index\"\n                    :title=\"`${item.textType === 'qrcode' ? '二维码' : `内容项${index + 1}`}`\">\n                    <a-form-item label=\"内容\">\n                        <a-input v-model:value=\"item.title\" />\n                    </a-form-item>\n                    <a-form-item label=\"宽度\">\n                        <a-input-number v-model:value=\"item.width\" />\n                    </a-form-item>\n                    <a-form-item label=\"高度\">\n                        <a-input-number v-model:value=\"item.height\" />\n                    </a-form-item>\n                    <a-form-item label=\"距离左上Y距离\">\n                        <a-input-number v-model:value=\"item.top\" />\n                    </a-form-item>\n                    <a-form-item label=\"距离左上X距离\">\n                        <a-input-number v-model:value=\"item.left\" />\n                    </a-form-item>\n                    <a-form-item label=\"行高\">\n                        <a-input-number v-model:value=\"item.lineHeight\" />\n                    </a-form-item>\n                    <a-form-item label=\"字体大小\">\n                        <a-input-number v-model:value=\"item.fontSize\" />\n                    </a-form-item>\n                    <a-form-item label=\"缩放大小\">\n                        <a-input-number v-model:value=\"item.scale\" />\n                    </a-form-item>\n                    <a-form-item label=\"字体格式\">\n                        <a-select v-model:value=\"item.fontFamily\" class='w-full'>\n                            <a-select-option value=\"Noto Sans SC\">思源黑体</a-select-option>\n                            <a-select-option value=\"alibaba\">阿里巴巴普惠体</a-select-option>\n                        </a-select>\n                    </a-form-item>\n                    <a-form-item label=\"对齐格式\">\n                        <a-select v-model:value=\"item.textAlign\">\n                            <a-select-option value=\"left\">左对齐</a-select-option>\n                            <a-select-option value=\"center\">居中</a-select-option>\n                            <a-select-option value=\"right\">右对齐</a-select-option>\n                        </a-select>\n                    </a-form-item>\n                    <a-form-item label=\"字体粗细\">\n                        <a-select v-model:value=\"item.fontWeight\">\n                            <a-select-option value=\"bold\">加粗</a-select-option>\n                            <a-select-option value=\"\">普通</a-select-option>\n                        </a-select>\n                    </a-form-item>\n                </a-card>\n            </a-form>\n        </div>\n        <div class=\"w-[50%] box-border p-2 flex-shrink-0\">\n            <div>\n                <a-button type=\"primary\" class=\"mx-2\" @click=\"printData('web')\">WEB打印</a-button>\n                <a-button type=\"primary\" @click=\"printData('static')\">静默打印</a-button>\n            </div>\n\n            <div style=\"height:450px;overflow-y: auto;background: #000;color:#fff;margin:40px auto\">{{ str }}</div>\n\n            <div id=\"design\"></div>\n        </div>\n    </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { reactive, ref, onMounted, watch } from 'vue';\nimport { hiprint } from 'vue-plugin-hiprint';\nimport type { IPrintItemOptions } from './type';\n\nconst panel = ref<Record<string, any>>()\nconst hiprintTemplate = ref<Record<string, any>>();\n\nconst printOptions = reactive({\n    width: 70,\n    height: 20,\n})\n\nconst str = ref('');\n\nconst list = ref([\n    {\n        textType: 'qrcode',\n        width: 35,\n        height: 35,\n        top: 10,\n        left: 2,\n        title: '123456',\n        fontFamily: 'Noto Sans SC',\n        fontSize: 9,\n        lineHeight: 9.75,\n        scale: 1,\n    },\n    {\n        width: 75,\n        height: 7,\n        top: 46,\n        left: -17,\n        title: 'KCY1234567980',\n        fontFamily: 'Noto Sans SC',\n        fontSize: 9,\n        textAlign: 'left',\n        fontWeight: 'bold',\n        lineHeight: 19.5,\n        scale: 0.5,\n    },\n    {\n        width: 110,\n        height: 15,\n        top: 5,\n        left: 40,\n        title: '五虎上将·关羽',\n        fontFamily: 'Noto Sans SC',\n        textAlign: 'center',\n        fontSize: 14,\n        lineHeight: 1,\n        fontWeight: 'bold',\n        scale: 0.5\n    },\n    {\n        width: 200,\n        height: 15,\n        top: 15,\n        left: -10,\n        title: '华立科技 •《三国幻战》•中国简中',\n        fontFamily: 'Noto Sans SC',\n        fontSize: 12,\n        lineHeight: 1,\n        textAlign: 'center',\n        fontWeight: 'bold',\n        scale: 0.5,\n    },\n    {\n        width: 110,\n        height: 15,\n        top: 22,\n        left: 40,\n        title: '2025年 五虎上将系列',\n        fontFamily: 'Noto Sans SC',\n        fontSize: 10,\n        lineHeight: 1,\n        textAlign: 'center',\n        fontWeight: 'bold',\n        scale: 0.5\n    },\n    {\n        width: 55,\n        height: 15,\n        top: 33,\n        left: 45,\n        title: 'CENTERING',\n        fontFamily: 'Noto Sans SC',\n        textAlign: 'left',\n        lineHeight: 1,\n        fontWeight: 'bold',\n        scale: 0.5,\n    },\n    {\n        width: 15,\n        height: 15,\n        top: 33,\n        left: 85,\n        title: '10',\n        fontFamily: 'Noto Sans SC',\n        lineHeight: 1,\n        textAlign: 'left',\n        fontWeight: 'bold',\n        scale: 0.5\n    },\n    {\n        width: 50,\n        height: 15,\n        top: 33,\n        left: 90,\n        title: 'CORNERS',\n        fontFamily: 'Noto Sans SC',\n        textAlign: 'left',\n        lineHeight: 1,\n        fontWeight: 'bold',\n        scale: 0.5\n    },\n    {\n        width: 15,\n        height: 15,\n        top: 33,\n        left: 122,\n        title: '10',\n        fontFamily: 'Noto Sans SC',\n        textAlign: 'left',\n        lineHeight: 1,\n        fontWeight: 'bold',\n        fontSize: 10,\n        scale: 0.5,\n    },\n    {\n        width: 55,\n        height: 15,\n        top: 40,\n        left: 45,\n        title: 'EDEGS',\n        fontFamily: 'Noto Sans SC',\n        lineHeight: 1,\n        textAlign: 'left',\n        fontWeight: 'bold',\n        scale: 0.5\n    },\n    {\n        width: 15,\n        height: 15,\n        top: 40,\n        left: 85,\n        title: '10',\n        fontFamily: 'Noto Sans SC',\n        lineHeight: 1,\n        textAlign: 'left',\n        fontWeight: 'bold',\n        scale: 0.5\n    },\n    {\n        width: 50,\n        height: 15,\n        top: 40,\n        left: 90,\n        title: 'SURFACE',\n        fontFamily: 'Noto Sans SC',\n        lineHeight: 1,\n        textAlign: 'left',\n        fontWeight: 'bold',\n        scale: 0.5\n    },\n    {\n        width: 15,\n        height: 15,\n        top: 40,\n        left: 122,\n        title: \"10\",\n        fontFamily: 'Noto Sans SC',\n        textAlign: 'left',\n        lineHeight: 1,\n        fontWeight: 'bold',\n        scale: 0.5\n    },\n    {\n        width: 130,\n        height: 15,\n        top: 9,\n        left: 104,\n        title: 'GEM MINT',\n        fontFamily: \"Noto Sans SC\",\n        textAlign: 'center',\n        fontSize: 16,\n        fontWeight: \"bold\",\n        lineHeight: 1,\n        scale: 0.5\n    },\n    {\n        width: 55,\n        height: 15,\n        top: 29,\n        left: 142,\n        title: '9.5',\n        fontFamily: \"Noto Sans SC\",\n        textAlign: 'center',\n        fontSize: 28,\n        fontWeight: \"bold\",\n        lineHeight: 1,\n        scale: 1\n    }\n])\n\n/**\n * 绘制\n */\nconst drawPrint = () => {\n    panel.value?.clear();\n    hiprintTemplate.value?.clear();\n    document.getElementById('design').innerHTML = '';\n    let _str = '';\n\n    hiprintTemplate.value = new (window as Record<string, any>).hiprint.PrintTemplate();\n    panel.value = hiprintTemplate.value.addPrintPanel({ width: printOptions.width, height: printOptions.height, paperFooter: 0, paperHeader: 0, paperNumberDisabled: true });\n\n    panel.value.addPrintText({ options: { width: printOptions.width, height: printOptions.height, top: 0, left: 0, src: \"https://search-operate.cdn.bcebos.com/c63f5b937296e91b1a9a79a63328b2a6.gif\" }, printElementType: { type: 'image' } })\n\n    list.value.forEach((i, index) => {\n        const { textType = 'text', width, height, left, top, title, scale = 1, fontSize = 9, fontFamily = 'Noto Sans SC', lineHeight = 9.75 } = i as IPrintItemOptions;\n        const options: Record<string, any> = { width, height, left, top, title, fontSize, fontFamily, lineHeight };\n        if (textType === 'qrcode') {\n            Object.assign(options, { textType: 'qrcode' })\n        }\n        if (!!i.textAlign) {\n            Object.assign(options, { textAlign: i.textAlign })\n        }\n        if (i.fontWeight === 'bold') {\n            Object.assign(options, { fontWeight: 'bold' })\n        }\n\n        const fn = new Function(`return { transform:\"scale(${scale || 1})\" }`)\n        const tempOptions = { ...options };\n\n        Object.assign(options, {\n            styler: fn\n        })\n\n        Object.assign(tempOptions, {\n            styler: `function(){return {transform:'scale(${scale || 1})'}}`\n        })\n\n        panel.value.addPrintText({ options });\n        _str += JSON.stringify(tempOptions) + (index === list.value.length - 1 ? \"\" : \",\");\n    })\n\n    hiprintTemplate.value.design('#design');\n    str.value = \"[\" + _str + \"]\"\n}\n\n/**\n * 打印数据\n */\nconst printData = (type: 'static' | 'web') => {\n    if (type === 'web') {\n        return hiprintTemplate.value.print({});\n    }\n\n    if (type === 'static') {\n        return hiprintTemplate.value.print2({});\n    }\n}\n\nonMounted(() => {\n    (window as Record<string, any>).hiprint.init();\n    drawPrint();\n})\n\nwatch([printOptions, list], () => {\n    drawPrint();\n}, { deep: true });\n\n</script>\n\n<style lang=\"scss\" scoped>\n.json-box {\n    height: 350px;\n    background-color: #f00;\n}\n</style>"],"names":["panel","ref","hiprintTemplate","printOptions","reactive","width","height","str","list","textType","top","left","title","fontFamily","fontSize","lineHeight","scale","textAlign","fontWeight","drawPrint","_a","value","clear","_b","document","getElementById","innerHTML","_str","window","hiprint","PrintTemplate","addPrintPanel","paperFooter","paperHeader","paperNumberDisabled","addPrintText","options","src","printElementType","type","forEach","i","index","Object","assign","fn","Function","tempOptions","styler","JSON","stringify","length","design","printData","print","print2","onMounted","init","watch","deep"],"mappings":"wmBAmFA,MAAMA,EAAQC,IACRC,EAAkBD,IAElBE,EAAeC,EAAS,CAC1BC,MAAO,GACPC,OAAQ,KAGNC,EAAMN,EAAI,IAEVO,EAAOP,EAAI,CACb,CACIQ,SAAU,SACVJ,MAAO,GACPC,OAAQ,GACRI,IAAK,GACLC,KAAM,EACNC,MAAO,SACPC,WAAY,eACZC,SAAU,EACVC,WAAY,KACZC,MAAO,GAEX,CACIX,MAAO,GACPC,OAAQ,EACRI,IAAK,GACLC,MAAM,GACNC,MAAO,gBACPC,WAAY,eACZC,SAAU,EACVG,UAAW,OACXC,WAAY,OACZH,WAAY,KACZC,MAAO,IAEX,CACIX,MAAO,IACPC,OAAQ,GACRI,IAAK,EACLC,KAAM,GACNC,MAAO,UACPC,WAAY,eACZI,UAAW,SACXH,SAAU,GACVC,WAAY,EACZG,WAAY,OACZF,MAAO,IAEX,CACIX,MAAO,IACPC,OAAQ,GACRI,IAAK,GACLC,MAAM,GACNC,MAAO,oBACPC,WAAY,eACZC,SAAU,GACVC,WAAY,EACZE,UAAW,SACXC,WAAY,OACZF,MAAO,IAEX,CACIX,MAAO,IACPC,OAAQ,GACRI,IAAK,GACLC,KAAM,GACNC,MAAO,eACPC,WAAY,eACZC,SAAU,GACVC,WAAY,EACZE,UAAW,SACXC,WAAY,OACZF,MAAO,IAEX,CACIX,MAAO,GACPC,OAAQ,GACRI,IAAK,GACLC,KAAM,GACNC,MAAO,YACPC,WAAY,eACZI,UAAW,OACXF,WAAY,EACZG,WAAY,OACZF,MAAO,IAEX,CACIX,MAAO,GACPC,OAAQ,GACRI,IAAK,GACLC,KAAM,GACNC,MAAO,KACPC,WAAY,eACZE,WAAY,EACZE,UAAW,OACXC,WAAY,OACZF,MAAO,IAEX,CACIX,MAAO,GACPC,OAAQ,GACRI,IAAK,GACLC,KAAM,GACNC,MAAO,UACPC,WAAY,eACZI,UAAW,OACXF,WAAY,EACZG,WAAY,OACZF,MAAO,IAEX,CACIX,MAAO,GACPC,OAAQ,GACRI,IAAK,GACLC,KAAM,IACNC,MAAO,KACPC,WAAY,eACZI,UAAW,OACXF,WAAY,EACZG,WAAY,OACZJ,SAAU,GACVE,MAAO,IAEX,CACIX,MAAO,GACPC,OAAQ,GACRI,IAAK,GACLC,KAAM,GACNC,MAAO,QACPC,WAAY,eACZE,WAAY,EACZE,UAAW,OACXC,WAAY,OACZF,MAAO,IAEX,CACIX,MAAO,GACPC,OAAQ,GACRI,IAAK,GACLC,KAAM,GACNC,MAAO,KACPC,WAAY,eACZE,WAAY,EACZE,UAAW,OACXC,WAAY,OACZF,MAAO,IAEX,CACIX,MAAO,GACPC,OAAQ,GACRI,IAAK,GACLC,KAAM,GACNC,MAAO,UACPC,WAAY,eACZE,WAAY,EACZE,UAAW,OACXC,WAAY,OACZF,MAAO,IAEX,CACIX,MAAO,GACPC,OAAQ,GACRI,IAAK,GACLC,KAAM,IACNC,MAAO,KACPC,WAAY,eACZI,UAAW,OACXF,WAAY,EACZG,WAAY,OACZF,MAAO,IAEX,CACIX,MAAO,IACPC,OAAQ,GACRI,IAAK,EACLC,KAAM,IACNC,MAAO,WACPC,WAAY,eACZI,UAAW,SACXH,SAAU,GACVI,WAAY,OACZH,WAAY,EACZC,MAAO,IAEX,CACIX,MAAO,GACPC,OAAQ,GACRI,IAAK,GACLC,KAAM,IACNC,MAAO,MACPC,WAAY,eACZI,UAAW,SACXH,SAAU,GACVI,WAAY,OACZH,WAAY,EACZC,MAAO,KAOTG,EAAY,aACd,OAAAC,EAAApB,EAAMqB,QAAOD,EAAAE,QACb,OAAAC,EAAArB,EAAgBmB,QAAOE,EAAAD,QACdE,SAAAC,eAAe,UAAUC,UAAY,GAC9C,IAAIC,EAAO,GAEXzB,EAAgBmB,MAAQ,IAAKO,OAA+BC,QAAQC,cACpE9B,EAAMqB,MAAQnB,EAAgBmB,MAAMU,cAAc,CAAE1B,MAAOF,EAAaE,MAAOC,OAAQH,EAAaG,OAAQ0B,YAAa,EAAGC,YAAa,EAAGC,qBAAqB,IAE3JlC,EAAAqB,MAAMc,aAAa,CAAEC,QAAS,CAAE/B,MAAOF,EAAaE,MAAOC,OAAQH,EAAaG,OAAQI,IAAK,EAAGC,KAAM,EAAG0B,IAAK,8EAAgFC,iBAAkB,CAAEC,KAAM,WAE9N/B,EAAKa,MAAMmB,QAAQ,CAACC,EAAGC,KACnB,MAAMjC,SAAEA,EAAW,OAAAJ,MAAQA,EAAOC,OAAAA,EAAAK,KAAQA,MAAMD,EAAKE,MAAAA,EAAAI,MAAOA,EAAQ,EAAAF,SAAGA,EAAW,EAAGD,WAAAA,EAAa,eAAgBE,WAAAA,EAAa,MAAS0B,EAClIL,EAA+B,CAAE/B,QAAOC,SAAQK,OAAMD,MAAKE,QAAOE,WAAUD,aAAYE,cAC7E,WAAbN,GACAkC,OAAOC,OAAOR,EAAS,CAAE3B,SAAU,WAEjCgC,EAAExB,WACJ0B,OAAOC,OAAOR,EAAS,CAAEnB,UAAWwB,EAAExB,YAErB,SAAjBwB,EAAEvB,YACFyB,OAAOC,OAAOR,EAAS,CAAElB,WAAY,SAGzC,MAAM2B,EAAK,IAAIC,SAAS,6BAA6B9B,GAAS,SACxD+B,EAAc,IAAKX,GAEzBO,OAAOC,OAAOR,EAAS,CACnBY,OAAQH,IAGZF,OAAOC,OAAOG,EAAa,CACvBC,OAAQ,uCAAuChC,GAAS,UAG5DhB,EAAMqB,MAAMc,aAAa,CAAEC,YACnBT,GAAAsB,KAAKC,UAAUH,IAAgBL,IAAUlC,EAAKa,MAAM8B,OAAS,EAAI,GAAK,OAGlEjD,EAAAmB,MAAM+B,OAAO,WACzB7C,EAAAc,MAAQ,IAAMM,EAAO,KAMvB0B,EAAad,GACF,QAATA,EACOrC,EAAgBmB,MAAMiC,MAAM,CAAE,GAG5B,WAATf,EACOrC,EAAgBmB,MAAMkC,OAAO,CAAE,QAD1C,SAKJC,EAAU,KACL5B,OAA+BC,QAAQ4B,aAI5CC,EAAM,CAACvD,EAAcK,GAAO,UAEzB,CAAEmD,MAAM"}